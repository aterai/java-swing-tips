<html><pre><span class="com">// -*- mode:java; encoding:utf-8 -*-</span><span class="pln"><br /></span><span class="com">// vim:set fileencoding=utf-8:</span><span class="pln"><br /></span><span class="com">// @homepage@</span><span class="pln"><br /><br /></span><span class="kwd">package</span><span class="pln"> example</span><span class="pun">;</span><span class="pln"><br /><br /></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">awt</span><span class="pun">.*;</span><span class="pln"><br /></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">awt</span><span class="pun">.</span><span class="kwd">event</span><span class="pun">.</span><span class="typ">ActionEvent</span><span class="pun">;</span><span class="pln"><br /></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">awt</span><span class="pun">.</span><span class="pln">geom</span><span class="pun">.</span><span class="typ">Area</span><span class="pun">;</span><span class="pln"><br /></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">awt</span><span class="pun">.</span><span class="pln">geom</span><span class="pun">.</span><span class="typ">PathIterator</span><span class="pun">;</span><span class="pln"><br /></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">awt</span><span class="pun">.</span><span class="pln">geom</span><span class="pun">.</span><span class="typ">Path2D</span><span class="pun">;</span><span class="pln"><br /></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">awt</span><span class="pun">.</span><span class="pln">geom</span><span class="pun">.</span><span class="typ">Point2D</span><span class="pun">;</span><span class="pln"><br /></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.</span><span class="typ">ArrayList</span><span class="pun">;</span><span class="pln"><br /></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.</span><span class="typ">List</span><span class="pun">;</span><span class="pln"><br /></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.</span><span class="pln">logging</span><span class="pun">.</span><span class="typ">Logger</span><span class="pun">;</span><span class="pln"><br /></span><span class="kwd">import</span><span class="pln"> javax</span><span class="pun">.</span><span class="pln">swing</span><span class="pun">.*;</span><span class="pln"><br /></span><span class="kwd">import</span><span class="pln"> javax</span><span class="pun">.</span><span class="pln">swing</span><span class="pun">.</span><span class="pln">plaf</span><span class="pun">.</span><span class="typ">TextUI</span><span class="pun">;</span><span class="pln"><br /></span><span class="kwd">import</span><span class="pln"> javax</span><span class="pun">.</span><span class="pln">swing</span><span class="pun">.</span><span class="pln">text</span><span class="pun">.*;</span><span class="pln"><br /></span><span class="kwd">import</span><span class="pln"> javax</span><span class="pun">.</span><span class="pln">swing</span><span class="pun">.</span><span class="pln">text</span><span class="pun">.</span><span class="typ">DefaultHighlighter</span><span class="pun">.</span><span class="typ">DefaultHighlightPainter</span><span class="pun">;</span><span class="pln"><br /></span><span class="kwd">import</span><span class="pln"> javax</span><span class="pun">.</span><span class="pln">swing</span><span class="pun">.</span><span class="pln">text</span><span class="pun">.</span><span class="typ">Highlighter</span><span class="pun">.</span><span class="typ">HighlightPainter</span><span class="pun">;</span><span class="pln"><br /><br /></span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">final</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">MainPanel</span><span class="pln"> </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">JPanel</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; </span><span class="kwd">private</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">final</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> TEXT </span><span class="pun">=</span><span class="pln"> </span><span class="typ">String</span><span class="pun">.</span><span class="pln">join</span><span class="pun">(</span><span class="str">"\n"</span><span class="pun">,</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="str">"Trail: Creating a GUI with JFC/Swing"</span><span class="pun">,</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="str">"Lesson: Learning Swing by Example"</span><span class="pun">,</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="str">"This lesson explains the concepts you need to"</span><span class="pun">,</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="str">" use Swing components in building a user interface."</span><span class="pun">,</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="str">" First we examine the simplest Swing application you can write."</span><span class="pun">,</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="str">" Then we present several progressively complicated examples of creating"</span><span class="pun">,</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="str">" user interfaces using components in the javax.swing package."</span><span class="pun">,</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="str">" We cover several Swing components, such as buttons, labels, and text areas."</span><span class="pun">,</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="str">" The handling of events is also discussed,"</span><span class="pun">,</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="str">" as are layout management and accessibility."</span><span class="pun">,</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="str">" This lesson ends with a set of questions and exercises"</span><span class="pun">,</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="str">" so you can test yourself on what you've learned."</span><span class="pun">,</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="str">"https://docs.oracle.com/javase/tutorial/uiswing/learn/index.html"</span><span class="pun">);</span><span class="pln"><br /><br />&#160; </span><span class="kwd">private</span><span class="pln"> </span><span class="typ">MainPanel</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; </span><span class="kwd">super</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">BorderLayout</span><span class="pun">(</span><span class="lit">5</span><span class="pun">,</span><span class="pln"> </span><span class="lit">5</span><span class="pun">));</span><span class="pln"><br />&#160; &#160; </span><span class="typ">JTextArea</span><span class="pln"> textArea </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">JTextArea</span><span class="pun">(</span><span class="pln">TEXT</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="lit">@Override</span><span class="pln"> </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> updateUI</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; &#160; &#160; </span><span class="kwd">super</span><span class="pun">.</span><span class="pln">updateUI</span><span class="pun">();</span><span class="pln"><br />&#160; &#160; &#160; &#160; </span><span class="typ">Caret</span><span class="pln"> caret </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">RoundedSelectionCaret</span><span class="pun">();</span><span class="pln"><br />&#160; &#160; &#160; &#160; caret</span><span class="pun">.</span><span class="pln">setBlinkRate</span><span class="pun">(</span><span class="typ">UIManager</span><span class="pun">.</span><span class="pln">getInt</span><span class="pun">(</span><span class="str">"TextArea.caretBlinkRate"</span><span class="pun">));</span><span class="pln"><br />&#160; &#160; &#160; &#160; setCaret</span><span class="pun">(</span><span class="pln">caret</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; &#160; &#160; </span><span class="pun">((</span><span class="typ">DefaultHighlighter</span><span class="pun">)</span><span class="pln"> getHighlighter</span><span class="pun">()).</span><span class="pln">setDrawsLayeredHighlights</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="pun">}</span><span class="pln"><br />&#160; &#160; </span><span class="pun">};</span><span class="pln"><br />&#160; &#160; </span><span class="typ">JCheckBox</span><span class="pln"> check </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">JCheckBox</span><span class="pun">(</span><span class="str">"setLineWrap / setWrapStyleWord:"</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; check</span><span class="pun">.</span><span class="pln">addActionListener</span><span class="pun">(</span><span class="pln">e </span><span class="pun">-&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="kwd">boolean</span><span class="pln"> b </span><span class="pun">=</span><span class="pln"> </span><span class="pun">((</span><span class="typ">JCheckBox</span><span class="pun">)</span><span class="pln"> e</span><span class="pun">.</span><span class="pln">getSource</span><span class="pun">()).</span><span class="pln">isSelected</span><span class="pun">();</span><span class="pln"><br />&#160; &#160; &#160; textArea</span><span class="pun">.</span><span class="pln">setLineWrap</span><span class="pun">(</span><span class="pln">b</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; &#160; textArea</span><span class="pun">.</span><span class="pln">setWrapStyleWord</span><span class="pun">(</span><span class="pln">b</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; </span><span class="pun">});</span><span class="pln"><br />&#160; &#160; add</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">JScrollPane</span><span class="pun">(</span><span class="pln">textArea</span><span class="pun">));</span><span class="pln"><br />&#160; &#160; add</span><span class="pun">(</span><span class="pln">check</span><span class="pun">,</span><span class="pln"> </span><span class="typ">BorderLayout</span><span class="pun">.</span><span class="pln">SOUTH</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; setBorder</span><span class="pun">(</span><span class="typ">BorderFactory</span><span class="pun">.</span><span class="pln">createEmptyBorder</span><span class="pun">(</span><span class="lit">5</span><span class="pun">,</span><span class="pln"> </span><span class="lit">5</span><span class="pun">,</span><span class="pln"> </span><span class="lit">5</span><span class="pun">,</span><span class="pln"> </span><span class="lit">5</span><span class="pun">));</span><span class="pln"><br />&#160; &#160; setPreferredSize</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Dimension</span><span class="pun">(</span><span class="lit">320</span><span class="pun">,</span><span class="pln"> </span><span class="lit">240</span><span class="pun">));</span><span class="pln"><br />&#160; </span><span class="pun">}</span><span class="pln"><br /><br />&#160; </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> main</span><span class="pun">(</span><span class="typ">String</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; </span><span class="typ">EventQueue</span><span class="pun">.</span><span class="pln">invokeLater</span><span class="pun">(</span><span class="typ">MainPanel</span><span class="pun">::</span><span class="pln">createAndShowGui</span><span class="pun">);</span><span class="pln"><br />&#160; </span><span class="pun">}</span><span class="pln"><br /><br />&#160; </span><span class="kwd">private</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> createAndShowGui</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; </span><span class="kwd">try</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="typ">UIManager</span><span class="pun">.</span><span class="pln">setLookAndFeel</span><span class="pun">(</span><span class="typ">UIManager</span><span class="pun">.</span><span class="pln">getSystemLookAndFeelClassName</span><span class="pun">());</span><span class="pln"><br />&#160; &#160; </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">catch</span><span class="pln"> </span><span class="pun">(</span><span class="typ">UnsupportedLookAndFeelException</span><span class="pln"> ignored</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="typ">Toolkit</span><span class="pun">.</span><span class="pln">getDefaultToolkit</span><span class="pun">().</span><span class="pln">beep</span><span class="pun">();</span><span class="pln"><br />&#160; &#160; </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">catch</span><span class="pln"> </span><span class="pun">(</span><span class="typ">ClassNotFoundException</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> </span><span class="typ">InstantiationException</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> </span><span class="typ">IllegalAccessException</span><span class="pln"> ex</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="typ">Logger</span><span class="pun">.</span><span class="pln">getGlobal</span><span class="pun">().</span><span class="pln">severe</span><span class="pun">(</span><span class="pln">ex</span><span class="pun">::</span><span class="pln">getMessage</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="kwd">return</span><span class="pun">;</span><span class="pln"><br />&#160; &#160; </span><span class="pun">}</span><span class="pln"><br />&#160; &#160; </span><span class="typ">JFrame</span><span class="pln"> frame </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">JFrame</span><span class="pun">(</span><span class="str">"@title@"</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; frame</span><span class="pun">.</span><span class="pln">setDefaultCloseOperation</span><span class="pun">(</span><span class="typ">WindowConstants</span><span class="pun">.</span><span class="pln">EXIT_ON_CLOSE</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; frame</span><span class="pun">.</span><span class="pln">getContentPane</span><span class="pun">().</span><span class="pln">add</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">MainPanel</span><span class="pun">());</span><span class="pln"><br />&#160; &#160; frame</span><span class="pun">.</span><span class="pln">pack</span><span class="pun">();</span><span class="pln"><br />&#160; &#160; frame</span><span class="pun">.</span><span class="pln">setLocationRelativeTo</span><span class="pun">(</span><span class="kwd">null</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; frame</span><span class="pun">.</span><span class="pln">setVisible</span><span class="pun">(</span><span class="kwd">true</span><span class="pun">);</span><span class="pln"><br />&#160; </span><span class="pun">}</span><span class="pln"><br /></span><span class="pun">}</span><span class="pln"><br /><br /></span><span class="kwd">class</span><span class="pln"> </span><span class="typ">RoundedSelectionCaret</span><span class="pln"> </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">DefaultCaret</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; </span><span class="lit">@Override</span><span class="pln"> </span><span class="kwd">protected</span><span class="pln"> </span><span class="typ">HighlightPainter</span><span class="pln"> getSelectionPainter</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">RoundedSelectionHighlightPainter</span><span class="pun">();</span><span class="pln"><br />&#160; </span><span class="pun">}</span><span class="pln"><br /><br />&#160; </span><span class="lit">@Override</span><span class="pln"> </span><span class="kwd">protected</span><span class="pln"> </span><span class="kwd">synchronized</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> damage</span><span class="pun">(</span><span class="typ">Rectangle</span><span class="pln"> r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; </span><span class="typ">JTextComponent</span><span class="pln"> c </span><span class="pun">=</span><span class="pln"> getComponent</span><span class="pun">();</span><span class="pln"><br />&#160; &#160; </span><span class="kwd">int</span><span class="pln"> startOffset </span><span class="pun">=</span><span class="pln"> c</span><span class="pun">.</span><span class="pln">getSelectionStart</span><span class="pun">();</span><span class="pln"><br />&#160; &#160; </span><span class="kwd">int</span><span class="pln"> endOffset </span><span class="pun">=</span><span class="pln"> c</span><span class="pun">.</span><span class="pln">getSelectionEnd</span><span class="pun">();</span><span class="pln"><br />&#160; &#160; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">startOffset </span><span class="pun">==</span><span class="pln"> endOffset</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="kwd">super</span><span class="pun">.</span><span class="pln">damage</span><span class="pun">(</span><span class="pln">r</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="typ">TextUI</span><span class="pln"> mapper </span><span class="pun">=</span><span class="pln"> c</span><span class="pun">.</span><span class="pln">getUI</span><span class="pun">();</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="kwd">try</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; &#160; &#160; </span><span class="typ">Rectangle</span><span class="pln"> p0 </span><span class="pun">=</span><span class="pln"> mapper</span><span class="pun">.</span><span class="pln">modelToView</span><span class="pun">(</span><span class="pln">c</span><span class="pun">,</span><span class="pln"> startOffset</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; &#160; &#160; </span><span class="typ">Rectangle</span><span class="pln"> p1 </span><span class="pun">=</span><span class="pln"> mapper</span><span class="pun">.</span><span class="pln">modelToView</span><span class="pun">(</span><span class="pln">c</span><span class="pun">,</span><span class="pln"> endOffset</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; &#160; &#160; </span><span class="kwd">int</span><span class="pln"> h </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pun">)</span><span class="pln"> </span><span class="pun">(</span><span class="pln">p1</span><span class="pun">.</span><span class="pln">getMaxY</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> p0</span><span class="pun">.</span><span class="pln">getMinY</span><span class="pun">());</span><span class="pln"><br />&#160; &#160; &#160; &#160; </span><span class="typ">Rectangle</span><span class="pln"> rr </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Rectangle</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> p0</span><span class="pun">.</span><span class="pln">y</span><span class="pun">,</span><span class="pln"> c</span><span class="pun">.</span><span class="pln">getWidth</span><span class="pun">(),</span><span class="pln"> h</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; &#160; &#160; c</span><span class="pun">.</span><span class="pln">repaint</span><span class="pun">(</span><span class="pln">rr</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">catch</span><span class="pln"> </span><span class="pun">(</span><span class="typ">BadLocationException</span><span class="pln"> ex</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; &#160; &#160; </span><span class="typ">UIManager</span><span class="pun">.</span><span class="pln">getLookAndFeel</span><span class="pun">().</span><span class="pln">provideErrorFeedback</span><span class="pun">(</span><span class="pln">c</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="pun">}</span><span class="pln"><br />&#160; &#160; </span><span class="pun">}</span><span class="pln"><br />&#160; </span><span class="pun">}</span><span class="pln"><br /></span><span class="pun">}</span><span class="pln"><br /><br /></span><span class="kwd">class</span><span class="pln"> </span><span class="typ">RoundedSelectionHighlightPainter</span><span class="pln"> </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">DefaultHighlightPainter</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; </span><span class="kwd">protected</span><span class="pln"> </span><span class="typ">RoundedSelectionHighlightPainter</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; </span><span class="kwd">super</span><span class="pun">(</span><span class="kwd">null</span><span class="pun">);</span><span class="pln"><br />&#160; </span><span class="pun">}</span><span class="pln"><br /><br />&#160; </span><span class="lit">@Override</span><span class="pln"> </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> paint</span><span class="pun">(</span><span class="typ">Graphics</span><span class="pln"> g</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> offs0</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> offs1</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Shape</span><span class="pln"> bounds</span><span class="pun">,</span><span class="pln"> </span><span class="typ">JTextComponent</span><span class="pln"> c</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; </span><span class="typ">Graphics2D</span><span class="pln"> g2 </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">Graphics2D</span><span class="pun">)</span><span class="pln"> g</span><span class="pun">.</span><span class="pln">create</span><span class="pun">();</span><span class="pln"><br />&#160; &#160; g2</span><span class="pun">.</span><span class="pln">setRenderingHint</span><span class="pun">(</span><span class="typ">RenderingHints</span><span class="pun">.</span><span class="pln">KEY_ANTIALIASING</span><span class="pun">,</span><span class="pln"> </span><span class="typ">RenderingHints</span><span class="pun">.</span><span class="pln">VALUE_ANTIALIAS_ON</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; </span><span class="typ">Color</span><span class="pln"> color </span><span class="pun">=</span><span class="pln"> c</span><span class="pun">.</span><span class="pln">getSelectionColor</span><span class="pun">();</span><span class="pln"><br />&#160; &#160; g2</span><span class="pun">.</span><span class="pln">setColor</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Color</span><span class="pun">(</span><span class="pln">color</span><span class="pun">.</span><span class="pln">getRed</span><span class="pun">(),</span><span class="pln"> color</span><span class="pun">.</span><span class="pln">getGreen</span><span class="pun">(),</span><span class="pln"> color</span><span class="pun">.</span><span class="pln">getBlue</span><span class="pun">(),</span><span class="pln"> </span><span class="lit">200</span><span class="pun">));</span><span class="pln"><br />&#160; &#160; </span><span class="kwd">try</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="typ">Area</span><span class="pln"> area </span><span class="pun">=</span><span class="pln"> getLinesArea</span><span class="pun">(</span><span class="pln">c</span><span class="pun">,</span><span class="pln"> offs0</span><span class="pun">,</span><span class="pln"> offs1</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="typ">Area</span><span class="pln"> a </span><span class="pun">:</span><span class="pln"> </span><span class="typ">GeomUtils</span><span class="pun">.</span><span class="pln">singularization</span><span class="pun">(</span><span class="pln">area</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; &#160; &#160; </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">Point2D</span><span class="pun">&gt;</span><span class="pln"> lst </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GeomUtils</span><span class="pun">.</span><span class="pln">convertAreaToPoint2DList</span><span class="pun">(</span><span class="pln">a</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; &#160; &#160; </span><span class="typ">GeomUtils</span><span class="pun">.</span><span class="pln">flatteningStepsOnRightSide</span><span class="pun">(</span><span class="pln">lst</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3d</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2d</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; &#160; &#160; g2</span><span class="pun">.</span><span class="pln">fill</span><span class="pun">(</span><span class="typ">GeomUtils</span><span class="pun">.</span><span class="pln">convertRoundedPath</span><span class="pun">(</span><span class="pln">lst</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3d</span><span class="pun">));</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="pun">}</span><span class="pln"><br />&#160; &#160; </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">catch</span><span class="pln"> </span><span class="pun">(</span><span class="typ">BadLocationException</span><span class="pln"> ex</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="com">// can't render</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="typ">Logger</span><span class="pun">.</span><span class="pln">getGlobal</span><span class="pun">().</span><span class="pln">severe</span><span class="pun">(</span><span class="pln">ex</span><span class="pun">::</span><span class="pln">getMessage</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; </span><span class="pun">}</span><span class="pln"><br />&#160; &#160; g2</span><span class="pun">.</span><span class="pln">dispose</span><span class="pun">();</span><span class="pln"><br />&#160; </span><span class="pun">}</span><span class="pln"><br /><br />&#160; </span><span class="kwd">private</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="typ">Area</span><span class="pln"> getLinesArea</span><span class="pun">(</span><span class="typ">JTextComponent</span><span class="pln"> c</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> offs0</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> offs1</span><span class="pun">)</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">BadLocationException</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; </span><span class="typ">TextUI</span><span class="pln"> mapper </span><span class="pun">=</span><span class="pln"> c</span><span class="pun">.</span><span class="pln">getUI</span><span class="pun">();</span><span class="pln"><br />&#160; &#160; </span><span class="typ">Area</span><span class="pln"> area </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Area</span><span class="pun">();</span><span class="pln"><br />&#160; &#160; </span><span class="kwd">int</span><span class="pln"> cur </span><span class="pun">=</span><span class="pln"> offs0</span><span class="pun">;</span><span class="pln"><br />&#160; &#160; </span><span class="kwd">do</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="kwd">int</span><span class="pln"> startOffset </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Utilities</span><span class="pun">.</span><span class="pln">getRowStart</span><span class="pun">(</span><span class="pln">c</span><span class="pun">,</span><span class="pln"> cur</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="kwd">int</span><span class="pln"> endOffset </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Utilities</span><span class="pun">.</span><span class="pln">getRowEnd</span><span class="pun">(</span><span class="pln">c</span><span class="pun">,</span><span class="pln"> cur</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="typ">Rectangle</span><span class="pln"> p0 </span><span class="pun">=</span><span class="pln"> mapper</span><span class="pun">.</span><span class="pln">modelToView</span><span class="pun">(</span><span class="pln">c</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Math</span><span class="pun">.</span><span class="pln">max</span><span class="pun">(</span><span class="pln">startOffset</span><span class="pun">,</span><span class="pln"> offs0</span><span class="pun">));</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="typ">Rectangle</span><span class="pln"> p1 </span><span class="pun">=</span><span class="pln"> mapper</span><span class="pun">.</span><span class="pln">modelToView</span><span class="pun">(</span><span class="pln">c</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Math</span><span class="pun">.</span><span class="pln">min</span><span class="pun">(</span><span class="pln">endOffset</span><span class="pun">,</span><span class="pln"> offs1</span><span class="pun">));</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">p0</span><span class="pun">.</span><span class="pln">x </span><span class="pun">!=</span><span class="pln"> p1</span><span class="pun">.</span><span class="pln">x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; &#160; &#160; area</span><span class="pun">.</span><span class="pln">add</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Area</span><span class="pun">(</span><span class="pln">p0</span><span class="pun">.</span><span class="kwd">union</span><span class="pun">(</span><span class="pln">p1</span><span class="pun">)));</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; &#160; &#160; p0</span><span class="pun">.</span><span class="pln">width </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">6</span><span class="pun">;</span><span class="pln"><br />&#160; &#160; &#160; &#160; area</span><span class="pun">.</span><span class="pln">add</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Area</span><span class="pun">(</span><span class="pln">p0</span><span class="pun">));</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="pun">}</span><span class="pln"><br />&#160; &#160; &#160; cur </span><span class="pun">=</span><span class="pln"> endOffset </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"><br />&#160; &#160; </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cur </span><span class="pun">&lt;</span><span class="pln"> offs1</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; </span><span class="kwd">return</span><span class="pln"> area</span><span class="pun">;</span><span class="pln"><br />&#160; </span><span class="pun">}</span><span class="pln"><br /></span><span class="pun">}</span><span class="pln"><br /><br /></span><span class="kwd">final</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">GeomUtils</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; </span><span class="kwd">private</span><span class="pln"> </span><span class="typ">GeomUtils</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; </span><span class="com">/* Singleton */</span><span class="pln"><br />&#160; </span><span class="pun">}</span><span class="pln"><br /><br />&#160; </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">Point2D</span><span class="pun">&gt;</span><span class="pln"> convertAreaToPoint2DList</span><span class="pun">(</span><span class="typ">Area</span><span class="pln"> area</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">Point2D</span><span class="pun">&gt;</span><span class="pln"> list </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ArrayList</span><span class="pun">&lt;&gt;();</span><span class="pln"><br />&#160; &#160; </span><span class="typ">PathIterator</span><span class="pln"> pi </span><span class="pun">=</span><span class="pln"> area</span><span class="pun">.</span><span class="pln">getPathIterator</span><span class="pun">(</span><span class="kwd">null</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; </span><span class="kwd">double</span><span class="pun">[]</span><span class="pln"> cd </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="kwd">double</span><span class="pun">[</span><span class="lit">6</span><span class="pun">];</span><span class="pln"><br />&#160; &#160; </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">pi</span><span class="pun">.</span><span class="pln">isDone</span><span class="pun">())</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="kwd">switch</span><span class="pln"> </span><span class="pun">(</span><span class="pln">pi</span><span class="pun">.</span><span class="pln">currentSegment</span><span class="pun">(</span><span class="pln">cd</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; &#160; &#160; </span><span class="kwd">case</span><span class="pln"> </span><span class="typ">PathIterator</span><span class="pun">.</span><span class="pln">SEG_MOVETO</span><span class="pun">:</span><span class="pln"><br />&#160; &#160; &#160; &#160; </span><span class="kwd">case</span><span class="pln"> </span><span class="typ">PathIterator</span><span class="pun">.</span><span class="pln">SEG_LINETO</span><span class="pun">:</span><span class="pln"><br />&#160; &#160; &#160; &#160; &#160; list</span><span class="pun">.</span><span class="pln">add</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Point2D</span><span class="pun">.</span><span class="typ">Double</span><span class="pun">(</span><span class="pln">cd</span><span class="pun">[</span><span class="lit">0</span><span class="pun">],</span><span class="pln"> cd</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]));</span><span class="pln"><br />&#160; &#160; &#160; &#160; &#160; </span><span class="kwd">break</span><span class="pun">;</span><span class="pln"><br />&#160; &#160; &#160; &#160; </span><span class="kwd">default</span><span class="pun">:</span><span class="pln"><br />&#160; &#160; &#160; &#160; &#160; </span><span class="kwd">break</span><span class="pun">;</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="pun">}</span><span class="pln"><br />&#160; &#160; &#160; pi</span><span class="pun">.</span><span class="kwd">next</span><span class="pun">();</span><span class="pln"><br />&#160; &#160; </span><span class="pun">}</span><span class="pln"><br />&#160; &#160; </span><span class="kwd">return</span><span class="pln"> list</span><span class="pun">;</span><span class="pln"><br />&#160; </span><span class="pun">}</span><span class="pln"><br /><br />&#160; </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> flatteningStepsOnRightSide</span><span class="pun">(</span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">Point2D</span><span class="pun">&gt;</span><span class="pln"> list</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">double</span><span class="pln"> arc</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; </span><span class="kwd">int</span><span class="pln"> sz </span><span class="pun">=</span><span class="pln"> list</span><span class="pun">.</span><span class="pln">size</span><span class="pun">();</span><span class="pln"><br />&#160; &#160; </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> sz</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="kwd">int</span><span class="pln"> i1 </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> sz</span><span class="pun">;</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="kwd">int</span><span class="pln"> i2 </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> sz</span><span class="pun">;</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="kwd">int</span><span class="pln"> i3 </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">3</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> sz</span><span class="pun">;</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="typ">Point2D</span><span class="pln"> pt0 </span><span class="pun">=</span><span class="pln"> list</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="typ">Point2D</span><span class="pln"> pt1 </span><span class="pun">=</span><span class="pln"> list</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="pln">i1</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="typ">Point2D</span><span class="pln"> pt2 </span><span class="pun">=</span><span class="pln"> list</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="pln">i2</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="typ">Point2D</span><span class="pln"> pt3 </span><span class="pun">=</span><span class="pln"> list</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="pln">i3</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="kwd">double</span><span class="pln"> dx1 </span><span class="pun">=</span><span class="pln"> pt2</span><span class="pun">.</span><span class="pln">getX</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> pt1</span><span class="pun">.</span><span class="pln">getX</span><span class="pun">();</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="typ">Math</span><span class="pun">.</span><span class="pln">abs</span><span class="pun">(</span><span class="pln">dx1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1.0e-1</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> </span><span class="typ">Math</span><span class="pun">.</span><span class="pln">abs</span><span class="pun">(</span><span class="pln">dx1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> arc</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; &#160; &#160; </span><span class="kwd">double</span><span class="pln"> max </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Math</span><span class="pun">.</span><span class="pln">max</span><span class="pun">(</span><span class="pln">pt0</span><span class="pun">.</span><span class="pln">getX</span><span class="pun">(),</span><span class="pln"> pt2</span><span class="pun">.</span><span class="pln">getX</span><span class="pun">());</span><span class="pln"><br />&#160; &#160; &#160; &#160; replace</span><span class="pun">(</span><span class="pln">list</span><span class="pun">,</span><span class="pln"> i</span><span class="pun">,</span><span class="pln"> max</span><span class="pun">,</span><span class="pln"> pt0</span><span class="pun">.</span><span class="pln">getY</span><span class="pun">());</span><span class="pln"><br />&#160; &#160; &#160; &#160; replace</span><span class="pun">(</span><span class="pln">list</span><span class="pun">,</span><span class="pln"> i1</span><span class="pun">,</span><span class="pln"> max</span><span class="pun">,</span><span class="pln"> pt1</span><span class="pun">.</span><span class="pln">getY</span><span class="pun">());</span><span class="pln"><br />&#160; &#160; &#160; &#160; replace</span><span class="pun">(</span><span class="pln">list</span><span class="pun">,</span><span class="pln"> i2</span><span class="pun">,</span><span class="pln"> max</span><span class="pun">,</span><span class="pln"> pt2</span><span class="pun">.</span><span class="pln">getY</span><span class="pun">());</span><span class="pln"><br />&#160; &#160; &#160; &#160; replace</span><span class="pun">(</span><span class="pln">list</span><span class="pun">,</span><span class="pln"> i3</span><span class="pun">,</span><span class="pln"> max</span><span class="pun">,</span><span class="pln"> pt3</span><span class="pun">.</span><span class="pln">getY</span><span class="pun">());</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="pun">}</span><span class="pln"><br />&#160; &#160; </span><span class="pun">}</span><span class="pln"><br />&#160; </span><span class="pun">}</span><span class="pln"><br /><br />&#160; </span><span class="kwd">private</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> replace</span><span class="pun">(</span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">Point2D</span><span class="pun">&gt;</span><span class="pln"> list</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">double</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">double</span><span class="pln"> y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; list</span><span class="pun">.</span><span class="pln">remove</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; list</span><span class="pun">.</span><span class="pln">add</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Point2D</span><span class="pun">.</span><span class="typ">Double</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> y</span><span class="pun">));</span><span class="pln"><br />&#160; </span><span class="pun">}</span><span class="pln"><br /><br />&#160; </span><span class="com">/**<br />&#160; &#160;* Rounding the corners of a Rectilinear Polygon.<br />&#160; &#160;*/</span><span class="pln"><br />&#160; </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="typ">Path2D</span><span class="pln"> convertRoundedPath</span><span class="pun">(</span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">Point2D</span><span class="pun">&gt;</span><span class="pln"> list</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">double</span><span class="pln"> arc</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; </span><span class="kwd">double</span><span class="pln"> kappa </span><span class="pun">=</span><span class="pln"> </span><span class="lit">4d</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="typ">Math</span><span class="pun">.</span><span class="pln">sqrt</span><span class="pun">(</span><span class="lit">2d</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1d</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">3d</span><span class="pun">;</span><span class="pln"> </span><span class="com">// = 0.55228...;</span><span class="pln"><br />&#160; &#160; </span><span class="kwd">double</span><span class="pln"> akv </span><span class="pun">=</span><span class="pln"> arc </span><span class="pun">-</span><span class="pln"> arc </span><span class="pun">*</span><span class="pln"> kappa</span><span class="pun">;</span><span class="pln"><br />&#160; &#160; </span><span class="kwd">int</span><span class="pln"> sz </span><span class="pun">=</span><span class="pln"> list</span><span class="pun">.</span><span class="pln">size</span><span class="pun">();</span><span class="pln"><br />&#160; &#160; </span><span class="typ">Point2D</span><span class="pln"> pt0 </span><span class="pun">=</span><span class="pln"> list</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; </span><span class="typ">Path2D</span><span class="pln"> path </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Path2D</span><span class="pun">.</span><span class="typ">Double</span><span class="pun">();</span><span class="pln"><br />&#160; &#160; path</span><span class="pun">.</span><span class="pln">moveTo</span><span class="pun">(</span><span class="pln">pt0</span><span class="pun">.</span><span class="pln">getX</span><span class="pun">()</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> arc</span><span class="pun">,</span><span class="pln"> pt0</span><span class="pun">.</span><span class="pln">getY</span><span class="pun">());</span><span class="pln"><br />&#160; &#160; </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> sz</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="typ">Point2D</span><span class="pln"> prv </span><span class="pun">=</span><span class="pln"> list</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">((</span><span class="pln">i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> sz</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> sz</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="typ">Point2D</span><span class="pln"> cur </span><span class="pun">=</span><span class="pln"> list</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="typ">Point2D</span><span class="pln"> nxt </span><span class="pun">=</span><span class="pln"> list</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">((</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> sz</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="kwd">double</span><span class="pln"> dx0 </span><span class="pun">=</span><span class="pln"> signum</span><span class="pun">(</span><span class="pln">cur</span><span class="pun">.</span><span class="pln">getX</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> prv</span><span class="pun">.</span><span class="pln">getX</span><span class="pun">(),</span><span class="pln"> arc</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="kwd">double</span><span class="pln"> dy0 </span><span class="pun">=</span><span class="pln"> signum</span><span class="pun">(</span><span class="pln">cur</span><span class="pun">.</span><span class="pln">getY</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> prv</span><span class="pun">.</span><span class="pln">getY</span><span class="pun">(),</span><span class="pln"> arc</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="kwd">double</span><span class="pln"> dx1 </span><span class="pun">=</span><span class="pln"> signum</span><span class="pun">(</span><span class="pln">nxt</span><span class="pun">.</span><span class="pln">getX</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> cur</span><span class="pun">.</span><span class="pln">getX</span><span class="pun">(),</span><span class="pln"> arc</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="kwd">double</span><span class="pln"> dy1 </span><span class="pun">=</span><span class="pln"> signum</span><span class="pun">(</span><span class="pln">nxt</span><span class="pun">.</span><span class="pln">getY</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> cur</span><span class="pun">.</span><span class="pln">getY</span><span class="pun">(),</span><span class="pln"> arc</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; &#160; path</span><span class="pun">.</span><span class="pln">curveTo</span><span class="pun">(</span><span class="pln"><br />&#160; &#160; &#160; &#160; &#160; cur</span><span class="pun">.</span><span class="pln">getX</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> dx0 </span><span class="pun">*</span><span class="pln"> akv</span><span class="pun">,</span><span class="pln"> cur</span><span class="pun">.</span><span class="pln">getY</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> dy0 </span><span class="pun">*</span><span class="pln"> akv</span><span class="pun">,</span><span class="pln"><br />&#160; &#160; &#160; &#160; &#160; cur</span><span class="pun">.</span><span class="pln">getX</span><span class="pun">()</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> dx1 </span><span class="pun">*</span><span class="pln"> akv</span><span class="pun">,</span><span class="pln"> cur</span><span class="pun">.</span><span class="pln">getY</span><span class="pun">()</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> dy1 </span><span class="pun">*</span><span class="pln"> akv</span><span class="pun">,</span><span class="pln"><br />&#160; &#160; &#160; &#160; &#160; cur</span><span class="pun">.</span><span class="pln">getX</span><span class="pun">()</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> dx1 </span><span class="pun">*</span><span class="pln"> arc</span><span class="pun">,</span><span class="pln"> cur</span><span class="pun">.</span><span class="pln">getY</span><span class="pun">()</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> dy1 </span><span class="pun">*</span><span class="pln"> arc</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; &#160; path</span><span class="pun">.</span><span class="pln">lineTo</span><span class="pun">(</span><span class="pln">nxt</span><span class="pun">.</span><span class="pln">getX</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> dx1 </span><span class="pun">*</span><span class="pln"> arc</span><span class="pun">,</span><span class="pln"> nxt</span><span class="pun">.</span><span class="pln">getY</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> dy1 </span><span class="pun">*</span><span class="pln"> arc</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; </span><span class="pun">}</span><span class="pln"><br />&#160; &#160; path</span><span class="pun">.</span><span class="pln">closePath</span><span class="pun">();</span><span class="pln"><br />&#160; &#160; </span><span class="kwd">return</span><span class="pln"> path</span><span class="pun">;</span><span class="pln"><br />&#160; </span><span class="pun">}</span><span class="pln"><br /><br />&#160; </span><span class="kwd">private</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">double</span><span class="pln"> signum</span><span class="pun">(</span><span class="kwd">double</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">double</span><span class="pln"> arc</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; </span><span class="kwd">return</span><span class="pln"> </span><span class="typ">Math</span><span class="pun">.</span><span class="pln">abs</span><span class="pun">(</span><span class="pln">v</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> arc </span><span class="pun">?</span><span class="pln"> </span><span class="lit">0d</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="typ">Math</span><span class="pun">.</span><span class="pln">signum</span><span class="pun">(</span><span class="pln">v</span><span class="pun">);</span><span class="pln"><br />&#160; </span><span class="pun">}</span><span class="pln"><br /><br />&#160; </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">Area</span><span class="pun">&gt;</span><span class="pln"> singularization</span><span class="pun">(</span><span class="typ">Area</span><span class="pln"> rect</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">Area</span><span class="pun">&gt;</span><span class="pln"> list </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ArrayList</span><span class="pun">&lt;&gt;();</span><span class="pln"><br />&#160; &#160; </span><span class="typ">Path2D</span><span class="pln"> path </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Path2D</span><span class="pun">.</span><span class="typ">Double</span><span class="pun">();</span><span class="pln"><br />&#160; &#160; </span><span class="typ">PathIterator</span><span class="pln"> pi </span><span class="pun">=</span><span class="pln"> rect</span><span class="pun">.</span><span class="pln">getPathIterator</span><span class="pun">(</span><span class="kwd">null</span><span class="pun">);</span><span class="pln"><br />&#160; &#160; </span><span class="kwd">double</span><span class="pun">[]</span><span class="pln"> cd </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="kwd">double</span><span class="pun">[</span><span class="lit">6</span><span class="pun">];</span><span class="pln"><br />&#160; &#160; </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">pi</span><span class="pun">.</span><span class="pln">isDone</span><span class="pun">())</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="kwd">switch</span><span class="pln"> </span><span class="pun">(</span><span class="pln">pi</span><span class="pun">.</span><span class="pln">currentSegment</span><span class="pun">(</span><span class="pln">cd</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&#160; &#160; &#160; &#160; </span><span class="kwd">case</span><span class="pln"> </span><span class="typ">PathIterator</span><span class="pun">.</span><span class="pln">SEG_MOVETO</span><span class="pun">:</span><span class="pln"><br />&#160; &#160; &#160; &#160; &#160; path</span><span class="pun">.</span><span class="pln">moveTo</span><span class="pun">(</span><span class="pln">cd</span><span class="pun">[</span><span class="lit">0</span><span class="pun">],</span><span class="pln"> cd</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]);</span><span class="pln"><br />&#160; &#160; &#160; &#160; &#160; </span><span class="kwd">break</span><span class="pun">;</span><span class="pln"><br />&#160; &#160; &#160; &#160; </span><span class="kwd">case</span><span class="pln"> </span><span class="typ">PathIterator</span><span class="pun">.</span><span class="pln">SEG_LINETO</span><span class="pun">:</span><span class="pln"><br />&#160; &#160; &#160; &#160; &#160; path</span><span class="pun">.</span><span class="pln">lineTo</span><span class="pun">(</span><span class="pln">cd</span><span class="pun">[</span><span class="lit">0</span><span class="pun">],</span><span class="pln"> cd</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]);</span><span class="pln"><br />&#160; &#160; &#160; &#160; &#160; </span><span class="kwd">break</span><span class="pun">;</span><span class="pln"><br />&#160; &#160; &#160; &#160; </span><span class="kwd">case</span><span class="pln"> </span><span class="typ">PathIterator</span><span class="pun">.</span><span class="pln">SEG_QUADTO</span><span class="pun">:</span><span class="pln"><br />&#160; &#160; &#160; &#160; &#160; path</span><span class="pun">.</span><span class="pln">quadTo</span><span class="pun">(</span><span class="pln">cd</span><span class="pun">[</span><span class="lit">0</span><span class="pun">],</span><span class="pln"> cd</span><span class="pun">[</span><span class="lit">1</span><span class="pun">],</span><span class="pln"> cd</span><span class="pun">[</span><span class="lit">2</span><span class="pun">],</span><span class="pln"> cd</span><span class="pun">[</span><span class="lit">3</span><span class="pun">]);</span><span class="pln"><br />&#160; &#160; &#160; &#160; &#160; </span><span class="kwd">break</span><span class="pun">;</span><span class="pln"><br />&#160; &#160; &#160; &#160; </span><span class="kwd">case</span><span class="pln"> </span><span class="typ">PathIterator</span><span class="pun">.</span><span class="pln">SEG_CUBICTO</span><span class="pun">:</span><span class="pln"><br />&#160; &#160; &#160; &#160; &#160; path</span><span class="pun">.</span><span class="pln">curveTo</span><span class="pun">(</span><span class="pln">cd</span><span class="pun">[</span><span class="lit">0</span><span class="pun">],</span><span class="pln"> cd</span><span class="pun">[</span><span class="lit">1</span><span class="pun">],</span><span class="pln"> cd</span><span class="pun">[</span><span class="lit">2</span><span class="pun">],</span><span class="pln"> cd</span><span class="pun">[</span><span class="lit">3</span><span class="pun">],</span><span class="pln"> cd</span><span class="pun">[</span><span class="lit">4</span><span class="pun">],</span><span class="pln"> cd</span><span class="pun">[</span><span class="lit">5</span><span class="pun">]);</span><span class="pln"><br />&#160; &#160; &#160; &#160; &#160; </span><span class="kwd">break</span><span class="pun">;</span><span class="pln"><br />&#160; &#160; &#160; &#160; </span><span class="kwd">case</span><span class="pln"> </span><span class="typ">PathIterator</span><span class="pun">.</span><span class="pln">SEG_CLOSE</span><span class="pun">:</span><span class="pln"><br />&#160; &#160; &#160; &#160; &#160; path</span><span class="pun">.</span><span class="pln">closePath</span><span class="pun">();</span><span class="pln"><br />&#160; &#160; &#160; &#160; &#160; list</span><span class="pun">.</span><span class="pln">add</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Area</span><span class="pun">(</span><span class="pln">path</span><span class="pun">));</span><span class="pln"><br />&#160; &#160; &#160; &#160; &#160; path</span><span class="pun">.</span><span class="pln">reset</span><span class="pun">();</span><span class="pln"><br />&#160; &#160; &#160; &#160; &#160; </span><span class="kwd">break</span><span class="pun">;</span><span class="pln"><br />&#160; &#160; &#160; &#160; </span><span class="kwd">default</span><span class="pun">:</span><span class="pln"><br />&#160; &#160; &#160; &#160; &#160; </span><span class="kwd">break</span><span class="pun">;</span><span class="pln"><br />&#160; &#160; &#160; </span><span class="pun">}</span><span class="pln"><br />&#160; &#160; &#160; pi</span><span class="pun">.</span><span class="kwd">next</span><span class="pun">();</span><span class="pln"><br />&#160; &#160; </span><span class="pun">}</span><span class="pln"><br />&#160; &#160; </span><span class="kwd">return</span><span class="pln"> list</span><span class="pun">;</span><span class="pln"><br />&#160; </span><span class="pun">}</span><span class="pln"><br /></span><span class="pun">}</span><span class="pln"><br /></span></pre></html>